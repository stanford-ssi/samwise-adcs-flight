#!/bin/bash

# Get the list of C/C++ files that were staged
staged_files=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(cpp|c|h)$')

if [ -n "$staged_files" ]; then
    echo "Formatting staged files..."
    echo "$staged_files" | xargs clang-format -i
    echo "Done!"

    # Re-add the formatted files
    echo "$staged_files" | xargs git add
fi

exit 0
